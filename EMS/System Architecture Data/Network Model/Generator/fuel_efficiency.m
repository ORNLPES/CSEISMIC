% fuel usage adapted from 200kW TQG numbersclcclearformat long ghome = cd;%% Read CSV filesfid = fopen(fullfile(home,'Generator model.csv'));data = textscan(fid,'%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s','Delimiter',',');fclose(fid);NG=length(data{1})-1;generators = cell(length(data{1}),length(data));for i = 1:length(data{1})    for j = 1:length(data)        generators(i,j) = data{j}(i);    endendcost_coeff=str2double(generators(2:end,9:16));for i=1:NG    cost_coeff(i,1:5)=cost_coeff(i,1:5)*cost_coeff(i,8);endPmin=str2double(generators(2:end,5))';Pmax=str2double(generators(2:end,6))';% Piecewise cost function datae1=(Pmax-Pmin)/3+Pmin;e2=(Pmax-Pmin)/3*2+Pmin;nlc=zeros(1,NG);for i=1:NG    nlc(i)=cost_coeff(i,5)+cost_coeff(i,4)*Pmin(i)/Pmax(i)+cost_coeff(i,3)*(Pmin(i)/Pmax(i))^2+cost_coeff(i,2)*(Pmin(i)/Pmax(i))^3++cost_coeff(i,1)*(Pmin(i)/Pmax(i))^4;endmc1=zeros(1,NG);for i=1:NG    mc1(i)=(cost_coeff(i,4)*e1(i)/Pmax(i)+cost_coeff(i,3)*(e1(i)/Pmax(i))^2+cost_coeff(i,2)*(e1(i)/Pmax(i))^3+cost_coeff(i,1)*(e1(i)/Pmax(i))^4-...            cost_coeff(i,4)*Pmin(i)/Pmax(i)-cost_coeff(i,3)*(Pmin(i)/Pmax(i))^2-cost_coeff(i,2)*(Pmin(i)/Pmax(i))^3-cost_coeff(i,1)*(Pmin(i)/Pmax(i))^4)/((Pmax(i)-Pmin(i))/3);endmc2=zeros(1,NG);for i=1:NG    mc2(i)=(cost_coeff(i,4)*e2(i)/Pmax(i)+cost_coeff(i,3)*(e2(i)/Pmax(i))^2+cost_coeff(i,2)*(e2(i)/Pmax(i))^3+cost_coeff(i,1)*(e2(i)/Pmax(i))^4-...            cost_coeff(i,4)*e1(i)/Pmax(i)-cost_coeff(i,3)*(e1(i)/Pmax(i))^2-cost_coeff(i,2)*(e1(i)/Pmax(i))^3-cost_coeff(i,1)*(e1(i)/Pmax(i))^4)/((Pmax(i)-Pmin(i))/3);endmc3=zeros(1,NG);for i=1:NG    mc3(i)=(cost_coeff(i,4)*Pmax(i)/Pmax(i)+cost_coeff(i,3)*(Pmax(i)/Pmax(i))^2+cost_coeff(i,2)*(Pmax(i)/Pmax(i))^3+cost_coeff(i,1)*(Pmax(i)/Pmax(i))^4-...            cost_coeff(i,4)*e2(i)/Pmax(i)-cost_coeff(i,3)*(e2(i)/Pmax(i))^2-cost_coeff(i,2)*(e2(i)/Pmax(i))^3-cost_coeff(i,1)*(e2(i)/Pmax(i))^4)/((Pmax(i)-Pmin(i))/3);endPiece_cost=[Pmin' e1' e2' Pmax' nlc' mc1' mc2' mc3'];    fprintf('P_min   e1    e2    P_max  nlc        mc1       mc2       mc3')Piece_cost% Write Cables Filefid = fopen(fullfile(home,'Generator Parameter.csv'),'w');fprintf(fid,'%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s\n',generators{1,1},generators{1,2},generators{1,3},generators{1,4},generators{1,5},...                                              generators{1,6},generators{1,7},generators{1,8},'e1','e2','nlc','mc1','mc2','mc3',generators{1,14},generators{1,15},generators{1,17});for j = 2:length(generators(:,1))    fprintf(fid,'%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s\n',generators{j,1},generators{j,2},generators{j,3},generators{j,4},generators{j,5},...                                                  generators{j,6},generators{j,7},generators{j,8},num2str(Piece_cost(j-1,2)),num2str(Piece_cost(j-1,3)),num2str(Piece_cost(j-1,5)),...                                                  num2str(Piece_cost(j-1,6)),num2str(Piece_cost(j-1,7)),num2str(Piece_cost(j-1,8)),generators{j,14},generators{j,15},generators{j,17});endfclose(fid);